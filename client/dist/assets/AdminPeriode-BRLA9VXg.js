import{t as E,v,w as C,r as o,F as c,x as D,s as n,j as e,B as r,M as h,I as R,y as Y}from"./index-CStZSlMe.js";import{A as y}from"./AdminLayout-CU4RY8Jx.js";import{F as B}from"./Table-qCIr8sZs.js";import{S as L}from"./index-BjnjwqG5.js";import{R as _}from"./DeleteOutlined-CXpESeIO.js";import{R as N}from"./DownloadOutlined-4V2MOGsX.js";import"./CalendarOutlined-C6xbjP1n.js";import"./index-BgWxMBed.js";import"./index-C594BSNH.js";import"./Pagination-Bimwde8a.js";const J=()=>{const{data:f=[],isLoading:g}=E(),[j]=v(),[k]=C(),[w,m]=o.useState(!1),[i]=c.useForm(),[d,l]=o.useState(null),[T,F]=o.useState(null),[I,{isSuccess:u,isLoading:b}]=D(),p=(s=null)=>{s?(i.setFieldsValue({name:s.tapel}),l(s.id)):(i.resetFields(),l(null)),m(!0)},x=()=>{m(!1),i.resetFields(),l(null)},M=async()=>{var s;try{const a=await i.validateFields(),t=await j({id:d,name:a.name}).unwrap();n.success(t.message),x()}catch(a){console.error("Error adding/updating period:",a),n.error(((s=a.data)==null?void 0:s.message)||"Terjadi kesalahan saat menyimpan data")}},P=s=>{h.confirm({title:"Konfirmasi Hapus",content:"Apakah Anda yakin ingin menghapus periode ini?",okText:"Ya",cancelText:"Tidak",onOk:async()=>{var a;try{const t=await k(s).unwrap();n.success(t.message)}catch(t){console.error("Error deleting period:",t),n.error(((a=t.data)==null?void 0:a.message)||"Terjadi kesalahan saat menghapus data")}}})},S=(s,a)=>{F(s),I({tapel:s,tapelname:a})};o.useEffect(()=>{u&&n.success("File berhasil didownload")},[u]);const A=[{title:"No",dataIndex:"index",key:"index",render:(s,a,t)=>t+1},{title:"Periode",dataIndex:"tapel",key:"tapel"},{title:"Aksi",key:"action",render:(s,a)=>e.jsxs(L,{size:"small",children:[e.jsx(r,{type:"primary",icon:e.jsx(Y,{}),onClick:()=>p(a)}),e.jsx(r,{type:"primary",danger:!0,icon:e.jsx(_,{}),onClick:()=>P(a.id)}),e.jsx(r,{type:"primary",icon:e.jsx(N,{}),loading:b&&T===a.id,onClick:()=>S(a.id,a.tapel)})]})}];return g?e.jsx(y,{title:"Periode",children:e.jsx("div",{children:"Loading..."})}):e.jsxs(y,{title:"Periode",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(r,{type:"primary",onClick:()=>p(),children:"Tambah Periode"})}),e.jsx(B,{dataSource:f,columns:A,rowKey:"id",pagination:!1}),e.jsx(h,{title:d?"Edit Periode":"Tambah Periode",open:w,onOk:M,onCancel:x,okText:d?"Update":"Tambah",cancelText:"Batal",children:e.jsx(c,{form:i,layout:"vertical",children:e.jsx(c.Item,{name:"name",label:"Nama Periode",rules:[{required:!0,message:"Nama periode harus diisi"}],children:e.jsx(R,{})})})})]})};export{J as default};
