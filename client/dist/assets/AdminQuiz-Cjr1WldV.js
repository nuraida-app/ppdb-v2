import{F as r,r as c,V as D,W as E,X as O,j as e,I as k,B as h,G as _,M as S,y as R,s as d}from"./index-CMEssXRz.js";import{A as G}from"./AdminLayout-B_3Hrh73.js";import{E as K}from"./Editor-BOX0dwul.js";import{S as f}from"./index-B2SgWHdp.js";import{F as V}from"./Table-CKS-BAtf.js";import{S as g}from"./index-BKxVm03t.js";import{R as $}from"./DeleteOutlined-CiED4gRi.js";import"./CalendarOutlined-D6AB9xU5.js";import"./index-nwPSw83I.js";import"./Pagination-CTc53qC1.js";const{Option:u}=g,B=n=>({__html:n}),ee=()=>{const[n]=r.useForm(),[b,p]=c.useState(!1),[I,P]=c.useState(""),[o,m]=c.useState(null),[s,y]=c.useState({current:1,pageSize:10}),{data:t,isLoading:T,refetch:x}=D({page:s.current,limit:s.pageSize,search:I}),[C]=E(),[F]=O(),M=a=>{y(a)},v=a=>{P(a),y({...s,current:1})},j=(a=null)=>{m(a),a?n.setFieldsValue({id:a.id,question:a.soal,type:a.jenis,input:a.pengisi}):n.resetFields(),p(!0)},z=()=>{p(!1),m(null),n.resetFields()},Q=async()=>{try{const a=await n.validateFields();await C(a),d.success(`Pertanyaan berhasil ${o?"diperbarui":"ditambahkan"}`),p(!1),m(null),n.resetFields(),x()}catch{d.error(`Gagal ${o?"memperbarui":"menambahkan"} pertanyaan`)}},w=async a=>{S.confirm({title:"Apakah anda yakin ingin menghapus pertanyaan ini?",content:"Data pertanyaan akan dihapus secara permanen",okText:"Ya",cancelText:"Tidak",onOk:async()=>{var i;try{const l=await F(a);d.success(l.message),x()}catch(l){d.error(((i=l.data)==null?void 0:i.message)||"Gagal menghapus pertanyaan")}}})},A=[{title:"No",key:"no",render:(a,i,l)=>(s.current-1)*s.pageSize+l+1},{title:"Pertanyaan",dataIndex:"soal",key:"soal",render:a=>e.jsx("div",{dangerouslySetInnerHTML:B(a)})},{title:"Jenis",dataIndex:"jenis",key:"jenis"},{title:"Pengisi",dataIndex:"pengisi",key:"pengisi",render:a=>a==="ortu"?"Orang Tua":"Calon Peserta Didik"},{title:"Action",key:"action",render:(a,i)=>e.jsxs(f,{size:"middle",children:[e.jsx(h,{type:"primary",icon:e.jsx(R,{}),onClick:()=>j(i),children:"Edit"}),e.jsx(h,{type:"primary",danger:!0,icon:e.jsx($,{}),onClick:()=>w(i.id),children:"Delete"})]})}];return e.jsxs(G,{title:"Kuisioner",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(f,{children:[e.jsx(k.Search,{placeholder:"Cari pertanyaan",onSearch:v,style:{width:200}}),e.jsx(h,{type:"primary",icon:e.jsx(_,{}),onClick:()=>j(),children:"Tambah Pertanyaan"})]})}),e.jsx(V,{columns:A,dataSource:t==null?void 0:t.questions,rowKey:"id",pagination:{...s,total:(t==null?void 0:t.totalPages)*s.pageSize},loading:T,onChange:M}),e.jsx(S,{title:o?"Edit Pertanyaan":"Tambah Pertanyaan",open:b,onOk:Q,onCancel:z,width:800,children:e.jsxs(r,{form:n,layout:"vertical",children:[o&&e.jsx(r.Item,{name:"id",label:"ID",children:e.jsx(k,{disabled:!0})}),e.jsx(r.Item,{name:"type",label:"Jenis",rules:[{required:!0,message:"Silakan pilih jenis!"}],children:e.jsxs(g,{placeholder:"Pilih jenis",children:[e.jsx(u,{value:"Kuisioner",children:"Kuisioner"}),e.jsx(u,{value:"Angket",children:"Angket"})]})}),e.jsx(r.Item,{name:"input",label:"Pengisi",rules:[{required:!0,message:"Silakan pilih pengisi!"}],children:e.jsxs(g,{placeholder:"Pilih pengisi",children:[e.jsx(u,{value:"ortu",children:"Orang Tua"}),e.jsx(u,{value:"Calon Peserta Didik",children:"Calon Peserta Didik"})]})}),e.jsx(r.Item,{name:"question",label:"Pertanyaan",rules:[{required:!0,message:"Silakan masukkan pertanyaan!"}],children:e.jsx(K,{})})]})})]})};export{ee as default};
